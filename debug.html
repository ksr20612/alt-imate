<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alt-imate ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .file-input {
      margin: 10px 0;
    }
    .log {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 5px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
    .success { color: green; }
    .error { color: red; }
    .info { color: blue; }
  </style>
</head>
<body>
  <h1>ğŸ› Alt-imate ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</h1>

  <div class="test-section">
    <h2>1ë‹¨ê³„: ê¸°ë³¸ JavaScript í…ŒìŠ¤íŠ¸</h2>
    <button id="basicTest">ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <div id="basicResult" class="log"></div>
  </div>

  <div class="test-section">
    <h2>2ë‹¨ê³„: DOM ìš”ì†Œ ì°¾ê¸° í…ŒìŠ¤íŠ¸</h2>
    <input type="file" id="fileInput" accept="image/*" class="file-input">
    <button id="domTest">DOM í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <div id="domResult" class="log"></div>
  </div>

  <div class="test-section">
    <h2>3ë‹¨ê³„: íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸</h2>
    <input type="file" id="fileInputTest" accept="image/*" class="file-input">
    <button id="eventTest">ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <div id="eventResult" class="log"></div>
  </div>

  <div class="test-section">
    <h2>4ë‹¨ê³„: ES ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸</h2>
    <button id="moduleTest">ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <div id="moduleResult" class="log"></div>
  </div>

  <script>
    let logCount = 0;

    function log(elementId, message, type = 'info') {
      const element = document.getElementById(elementId);
      const timestamp = new Date().toLocaleTimeString();
      const logMessage = `[${timestamp}] ${message}\n`;
      element.innerHTML += `<span class="${type}">${logMessage}</span>`;
      element.scrollTop = element.scrollHeight;
      console.log(message);
    }

    // 1ë‹¨ê³„: ê¸°ë³¸ JavaScript í…ŒìŠ¤íŠ¸
    document.getElementById('basicTest').addEventListener('click', () => {
      const resultId = 'basicResult';
      document.getElementById(resultId).innerHTML = '';

      try {
        log(resultId, 'âœ… JavaScript ê¸°ë³¸ ì‹¤í–‰ ê°€ëŠ¥', 'success');
        log(resultId, `âœ… Document ê°ì²´: ${typeof document}`, 'success');
        log(resultId, `âœ… Console ê°ì²´: ${typeof console}`, 'success');
        log(resultId, `âœ… Window ê°ì²´: ${typeof window}`, 'success');

        // ê°„ë‹¨í•œ DOM ì¡°ì‘ í…ŒìŠ¤íŠ¸
        const testDiv = document.createElement('div');
        testDiv.textContent = 'Test Element';
        log(resultId, 'âœ… DOM ìš”ì†Œ ìƒì„± ê°€ëŠ¥', 'success');

      } catch (error) {
        log(resultId, `âŒ ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    });

    // 2ë‹¨ê³„: DOM ìš”ì†Œ ì°¾ê¸° í…ŒìŠ¤íŠ¸
    document.getElementById('domTest').addEventListener('click', () => {
      const resultId = 'domResult';
      document.getElementById(resultId).innerHTML = '';

      try {
        const fileInput = document.getElementById('fileInput');
        log(resultId, `íŒŒì¼ ì…ë ¥ ìš”ì†Œ: ${fileInput ? 'âœ… ì°¾ìŒ' : 'âŒ ëª»ì°¾ìŒ'}`, fileInput ? 'success' : 'error');

        if (fileInput) {
          log(resultId, `- íƒœê·¸ëª…: ${fileInput.tagName}`, 'info');
          log(resultId, `- ID: ${fileInput.id}`, 'info');
          log(resultId, `- accept ì†ì„±: ${fileInput.accept}`, 'info');
        }

        // ë‹¤ë¥¸ ìš”ì†Œë“¤ë„ í…ŒìŠ¤íŠ¸
        const body = document.querySelector('body');
        log(resultId, `Body ìš”ì†Œ: ${body ? 'âœ… ì°¾ìŒ' : 'âŒ ëª»ì°¾ìŒ'}`, body ? 'success' : 'error');

      } catch (error) {
        log(resultId, `âŒ DOM í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    });

    // 3ë‹¨ê³„: íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸
    document.getElementById('eventTest').addEventListener('click', () => {
      const resultId = 'eventResult';
      document.getElementById(resultId).innerHTML = '';

      try {
        const fileInputTest = document.getElementById('fileInputTest');

        if (!fileInputTest) {
          log(resultId, 'âŒ íŒŒì¼ ì…ë ¥ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
          return;
        }

        log(resultId, 'âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì‹œì‘...', 'info');

        // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
        fileInputTest.removeEventListener('change', fileChangeHandler);

        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ì˜
        function fileChangeHandler(e) {
          log(resultId, 'ğŸ‰ íŒŒì¼ ë³€ê²½ ì´ë²¤íŠ¸ ë°œìƒ!', 'success');
          const file = e.target.files[0];
          if (file) {
            log(resultId, `- íŒŒì¼ëª…: ${file.name}`, 'info');
            log(resultId, `- íŒŒì¼ í¬ê¸°: ${file.size} bytes`, 'info');
            log(resultId, `- íŒŒì¼ íƒ€ì…: ${file.type}`, 'info');
          } else {
            log(resultId, '- ì„ íƒëœ íŒŒì¼ ì—†ìŒ', 'info');
          }
        }

        fileInputTest.addEventListener('change', fileChangeHandler);
        log(resultId, 'âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ - ì´ì œ íŒŒì¼ì„ ì„ íƒí•´ë³´ì„¸ìš”!', 'success');

      } catch (error) {
        log(resultId, `âŒ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    });

    // 4ë‹¨ê³„: ES ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ (ë™ì  import ì‚¬ìš©)
    document.getElementById('moduleTest').addEventListener('click', async () => {
      const resultId = 'moduleResult';
      document.getElementById(resultId).innerHTML = '';

      try {
        log(resultId, 'ğŸ“¦ ES ëª¨ë“ˆ ë¡œë”© ì‹œë„...', 'info');

        // íŒŒì¼ ì¡´ì¬ í™•ì¸
        try {
          const response = await fetch('./dist/browser/index.js');
          log(resultId, `ëª¨ë“ˆ íŒŒì¼ ìƒíƒœ: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');

          if (!response.ok) {
            log(resultId, 'âŒ ëª¨ë“ˆ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¹Œë“œê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error');
            return;
          }
        } catch (fetchError) {
          log(resultId, `âŒ ëª¨ë“ˆ íŒŒì¼ ì ‘ê·¼ ì‹¤íŒ¨: ${fetchError.message}`, 'error');
          return;
        }

        // ë™ì  import ì‹œë„
        try {
          const module = await import('./dist/browser/index.js');
          log(resultId, 'âœ… ES ëª¨ë“ˆ ë¡œë”© ì„±ê³µ!', 'success');
          log(resultId, `- ë‚´ë³´ë‚¸ í•¨ìˆ˜ë“¤: ${Object.keys(module).join(', ')}`, 'info');

          // ê¸°ë³¸ í•¨ìˆ˜ë“¤ í™•ì¸
          if (module.analyzeImage) {
            log(resultId, 'âœ… analyzeImage í•¨ìˆ˜ ë°œê²¬', 'success');
          }
          if (module.preloadModel) {
            log(resultId, 'âœ… preloadModel í•¨ìˆ˜ ë°œê²¬', 'success');
          }

        } catch (importError) {
          log(resultId, `âŒ ES ëª¨ë“ˆ import ì‹¤íŒ¨: ${importError.message}`, 'error');
        }

      } catch (error) {
        log(resultId, `âŒ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`, 'error');
      }
    });

    // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ ì‹¤í–‰
    window.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ” ë””ë²„ê·¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
    });
  </script>
</body>
</html>
